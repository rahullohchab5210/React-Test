import React, { useEffect, useState } from 'react'
import { Link } from 'react-router-dom';

function Navbar() {
    const [menuOpen, setMenuOpen] = useState(null);
    const [cartCount, setCartCount] = useState(0);

    const navlinks = ["home", "conatct", "cart"]

    useEffect(() => {
        const items = JSON.parse(localStorage.getItem("Products")) || [];
        setCartCount(items.length);

        const updateCart = () => {
            const items = JSON.parse(localStorage.getItem("Products")) || [];
            setCartCount(items.length);
        };

        window.addEventListener("cartUpdated", updateCart);

        return () => {
            window.removeEventListener("cartUpdated", updateCart);
        };
    }, []);

   


    return (
        <div className='w-full sticky top-0  transition-all duration-200 ease-in-out z-20'>
            <div className='bg-white w-full'>
                <div className='max-w-[1140px] px-3 mx-auto'>
                    <div className='flex items-center justify-between w-full py-[10.2px]'>
                        <div className='flex items-center gap-[11px]'>
                            <span><svg width="45" height="17" viewBox="0 0 45 17" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M40.4628 0H0V17H40.4628L45 9.48423L40.4628 0Z" fill="#01C6B5" />
                                <path d="M6.66406 12.6044V4.27637H7.79206V12.6044H6.66406ZM7.43206 8.94437V7.91237H11.7761V8.94437H7.43206ZM7.43206 5.30837V4.27637H11.9801V5.30837H7.43206Z" fill="white" />
                                <path d="M13.2689 12.6044V6.90437H14.3489V12.6044H13.2689ZM14.3489 9.35237L13.9409 9.17237C13.9409 8.44437 14.1089 7.86437 14.4449 7.43237C14.7809 7.00037 15.2649 6.78437 15.8969 6.78437C16.1849 6.78437 16.4449 6.83637 16.6769 6.94037C16.9089 7.03637 17.1249 7.20037 17.3249 7.43237L16.6169 8.16437C16.4969 8.03637 16.3649 7.94437 16.2209 7.88837C16.0769 7.83237 15.9089 7.80437 15.7169 7.80437C15.3169 7.80437 14.9889 7.93237 14.7329 8.18837C14.4769 8.44437 14.3489 8.83237 14.3489 9.35237Z" fill="white" />
                                <path d="M20.5378 12.7244C19.9698 12.7244 19.4578 12.5964 19.0018 12.3404C18.5458 12.0764 18.1858 11.7204 17.9218 11.2724C17.6578 10.8244 17.5258 10.3164 17.5258 9.74837C17.5258 9.18837 17.6538 8.68437 17.9098 8.23637C18.1738 7.78837 18.5258 7.43637 18.9658 7.18037C19.4138 6.91637 19.9138 6.78437 20.4658 6.78437C20.9938 6.78437 21.4578 6.90437 21.8578 7.14437C22.2658 7.38437 22.5818 7.71637 22.8058 8.14037C23.0378 8.56437 23.1538 9.04437 23.1538 9.58037C23.1538 9.66037 23.1498 9.74837 23.1418 9.84437C23.1338 9.93237 23.1178 10.0364 23.0938 10.1564H18.2818V9.25637H22.5178L22.1218 9.60437C22.1218 9.22037 22.0538 8.89637 21.9178 8.63237C21.7818 8.36037 21.5898 8.15237 21.3418 8.00837C21.0938 7.85637 20.7938 7.78037 20.4418 7.78037C20.0738 7.78037 19.7498 7.86037 19.4698 8.02037C19.1898 8.18037 18.9738 8.40437 18.8218 8.69237C18.6698 8.98037 18.5938 9.32037 18.5938 9.71237C18.5938 10.1124 18.6738 10.4644 18.8338 10.7684C18.9938 11.0644 19.2218 11.2964 19.5178 11.4644C19.8138 11.6244 20.1538 11.7044 20.5378 11.7044C20.8578 11.7044 21.1498 11.6484 21.4138 11.5364C21.6858 11.4244 21.9178 11.2564 22.1098 11.0324L22.8058 11.7404C22.5338 12.0604 22.1978 12.3044 21.7978 12.4724C21.4058 12.6404 20.9858 12.7244 20.5378 12.7244Z" fill="white" />
                                <path d="M26.9714 12.7244C26.4034 12.7244 25.8914 12.5964 25.4354 12.3404C24.9794 12.0764 24.6194 11.7204 24.3554 11.2724C24.0914 10.8244 23.9594 10.3164 23.9594 9.74837C23.9594 9.18837 24.0874 8.68437 24.3434 8.23637C24.6074 7.78837 24.9594 7.43637 25.3994 7.18037C25.8474 6.91637 26.3474 6.78437 26.8994 6.78437C27.4274 6.78437 27.8914 6.90437 28.2914 7.14437C28.6994 7.38437 29.0154 7.71637 29.2394 8.14037C29.4714 8.56437 29.5874 9.04437 29.5874 9.58037C29.5874 9.66037 29.5834 9.74837 29.5754 9.84437C29.5674 9.93237 29.5514 10.0364 29.5274 10.1564H24.7154V9.25637H28.9514L28.5554 9.60437C28.5554 9.22037 28.4874 8.89637 28.3514 8.63237C28.2154 8.36037 28.0234 8.15237 27.7754 8.00837C27.5274 7.85637 27.2274 7.78037 26.8754 7.78037C26.5074 7.78037 26.1834 7.86037 25.9034 8.02037C25.6234 8.18037 25.4074 8.40437 25.2554 8.69237C25.1034 8.98037 25.0274 9.32037 25.0274 9.71237C25.0274 10.1124 25.1074 10.4644 25.2674 10.7684C25.4274 11.0644 25.6554 11.2964 25.9514 11.4644C26.2474 11.6244 26.5874 11.7044 26.9714 11.7044C27.2914 11.7044 27.5834 11.6484 27.8474 11.5364C28.1194 11.4244 28.3514 11.2564 28.5434 11.0324L29.2394 11.7404C28.9674 12.0604 28.6314 12.3044 28.2314 12.4724C27.8394 12.6404 27.4194 12.7244 26.9714 12.7244Z" fill="white" />
                                <circle cx="36.0396" cy="8.50006" r="2.45172" fill="white" />
                            </svg>
                            </span>
                            <h4 className='font-normal text-[16px] leading-[100%] tracking-[0%] text-[#414143]'>Free delivery & free returns within 15 days</h4>
                        </div>
                        <div className='flex items-center gap-[9px] max-sm:hidden'>
                            <span><svg width="30" height="30" viewBox="0 0 30 30" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <rect x="0.394163" y="0.394163" width="29.168" height="29.168" rx="14.584" stroke="#01C6B5" stroke-width="0.788326" />
                                <path d="M18.5142 18.5337L20.7399 20.7594M20.0367 14.617C20.0367 16.0544 19.4657 17.4329 18.4493 18.4493C17.4329 19.4657 16.0544 20.0367 14.617 20.0367C13.1796 20.0367 11.8011 19.4657 10.7847 18.4493C9.76827 17.4329 9.19727 16.0544 9.19727 14.617C9.19727 13.1796 9.76827 11.8011 10.7847 10.7847C11.8011 9.76827 13.1796 9.19727 14.617 9.19727C16.0544 9.19727 17.4329 9.76827 18.4493 10.7847C19.4657 11.8011 20.0367 13.1796 20.0367 14.617Z" stroke="#01C6B5" stroke-width="1.2" stroke-linecap="round" stroke-linejoin="round" />
                            </svg>
                            </span>
                            <span><svg width="30" height="30" viewBox="0 0 30 30" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <rect x="0.394163" y="0.394163" width="29.168" height="29.168" rx="14.584" stroke="#01C6B5" stroke-width="0.788326" />
                                <path d="M14.9775 16.2583C16.8926 16.2583 18.633 16.6211 19.8975 17.2114C21.1534 17.7978 21.9754 18.6274 21.9756 19.5767V21.9761H7.98047V19.5767C7.98065 18.6274 8.8026 17.7979 10.0586 17.2114C11.323 16.6211 13.0626 16.2583 14.9775 16.2583ZM14.9775 17.3774C13.3359 17.3775 11.8538 17.6337 10.7861 18.0444C10.2522 18.2499 9.8272 18.4926 9.53711 18.7563C9.2471 19.02 9.09972 19.2973 9.09961 19.5767V20.8569H20.8564V19.5767C20.8563 19.2973 20.709 19.02 20.4189 18.7563C20.1288 18.4925 19.7031 18.2499 19.1689 18.0444C18.1013 17.6338 16.6192 17.3774 14.9775 17.3774ZM14.9775 7.98096C15.8578 7.98096 16.7028 8.3302 17.3252 8.95264C17.9475 9.57499 18.2968 10.4192 18.2969 11.2993C18.2969 12.1794 17.9474 13.0236 17.3252 13.646C16.7028 14.2684 15.8578 14.6187 14.9775 14.6187C14.0974 14.6185 13.2532 14.2683 12.6309 13.646C12.0086 13.0236 11.6592 12.1794 11.6592 11.2993C11.6592 10.4192 12.0085 9.575 12.6309 8.95264C13.2532 8.3303 14.0974 7.98106 14.9775 7.98096ZM14.9775 9.1001C14.3944 9.1002 13.8352 9.33227 13.4229 9.74463C13.0105 10.157 12.7784 10.7162 12.7783 11.2993C12.7783 11.8826 13.0104 12.4425 13.4229 12.855C13.8352 13.2672 14.3945 13.4984 14.9775 13.4985C15.5608 13.4985 16.1208 13.2674 16.5332 12.855C16.9456 12.4425 17.1768 11.8826 17.1768 11.2993C17.1767 10.7162 16.9455 10.157 16.5332 9.74463C16.1208 9.33218 15.5608 9.1001 14.9775 9.1001Z" fill="#01C6B5" stroke="#01C6B5" stroke-width="0.2" />
                            </svg>
                            </span>
                            <Link to={"/cart"} className='relative'><svg width="30" height="32" viewBox="0 0 30 32" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <rect x="0.394163" y="2.39416" width="29.168" height="29.168" rx="14.584" stroke="#01C6B5" stroke-width="0.788326" />
                                <g clip-path="url(#clip0_3001_800)">
                                    <path d="M11.3652 21.2139C11.775 21.2139 12.1682 21.3772 12.458 21.667C12.7476 21.9568 12.9102 22.3501 12.9102 22.7598C12.91 23.1693 12.7475 23.5619 12.458 23.8516C12.1682 24.1413 11.775 24.3046 11.3652 24.3047C10.9554 24.3047 10.5623 24.1414 10.2725 23.8516C9.9829 23.5619 9.81945 23.1693 9.81934 22.7598C9.81934 22.35 9.98275 21.9568 10.2725 21.667C10.5623 21.3772 10.9554 21.2139 11.3652 21.2139ZM17.8691 21.2139C18.2788 21.214 18.6722 21.3773 18.9619 21.667C19.2515 21.9567 19.4141 22.3501 19.4141 22.7598C19.414 23.1692 19.2513 23.5619 18.9619 23.8516C18.6722 24.1413 18.2788 24.3046 17.8691 24.3047C17.4593 24.3047 17.0662 24.1414 16.7764 23.8516C16.4867 23.5619 16.3234 23.1694 16.3232 22.7598C16.3232 22.3499 16.4866 21.9568 16.7764 21.667C17.0662 21.3772 17.4593 21.2139 17.8691 21.2139ZM11.3652 22.1367C11.2001 22.1367 11.0416 22.2026 10.9248 22.3193C10.8081 22.4361 10.7422 22.5947 10.7422 22.7598C10.7423 22.9247 10.8083 23.0826 10.9248 23.1992C11.0416 23.316 11.2001 23.3818 11.3652 23.3818C11.5303 23.3818 11.6889 23.316 11.8057 23.1992C11.9221 23.0826 11.9872 22.9246 11.9873 22.7598C11.9873 22.5948 11.9223 22.4361 11.8057 22.3193C11.6889 22.2026 11.5303 22.1368 11.3652 22.1367ZM17.8691 22.1367C17.704 22.1367 17.5455 22.2026 17.4287 22.3193C17.312 22.4361 17.2461 22.5946 17.2461 22.7598C17.2462 22.9247 17.3121 23.0826 17.4287 23.1992C17.5455 23.316 17.704 23.3818 17.8691 23.3818C18.0341 23.3817 18.1919 23.3159 18.3086 23.1992C18.4253 23.0826 18.4911 22.9247 18.4912 22.7598C18.4912 22.5946 18.4254 22.4361 18.3086 22.3193C18.1919 22.2027 18.0341 22.1368 17.8691 22.1367ZM8.54102 10.375L8.56641 10.4355L9.15527 11.8203H19.3145C19.724 11.8204 20.1166 11.9829 20.4062 12.2725C20.696 12.5623 20.8594 12.9554 20.8594 13.3652C20.8594 13.7492 20.7281 14.073 20.5137 14.335L18.4121 17.1436C18.1342 17.5373 17.6718 17.8007 17.1465 17.8008H11.333L10.8096 18.8604L10.7422 19.1553C10.7445 19.3171 10.8102 19.4723 10.9248 19.5869C11.0415 19.7035 11.2002 19.7686 11.3652 19.7686H19.4141V20.6914H11.3652C10.9555 20.6914 10.5622 20.5289 10.2725 20.2393C9.98274 19.9495 9.81941 19.5562 9.81934 19.1465C9.81911 18.8843 9.88578 18.6259 10.0127 18.3965L10.5107 17.3799L7.93066 11.2969H6.92969V10.375H8.54102ZM11.3008 16.8779H17.1465C17.3517 16.8778 17.5324 16.7784 17.6445 16.6289L19.8125 13.7383L19.8662 13.6553C19.9124 13.5679 19.9365 13.4686 19.9365 13.3652C19.9365 13.2001 19.8707 13.0416 19.7539 12.9248C19.6373 12.8083 19.4793 12.7423 19.3145 12.7422H9.54297L11.3008 16.8779Z" fill="#01C6B5" stroke="#01C6B5" stroke-width="0.2" />
                                </g>
                                <rect x="22" width="6" height="6" rx="3" fill="#01C6B5" />
                                <path d="M24.078 3.766L24.873 2.935C24.929 2.875 24.974 2.822 25.008 2.776C25.044 2.728 25.07 2.683 25.086 2.641C25.102 2.597 25.11 2.553 25.11 2.509C25.11 2.421 25.081 2.352 25.023 2.302C24.967 2.252 24.894 2.227 24.804 2.227C24.712 2.227 24.63 2.251 24.558 2.299C24.488 2.347 24.422 2.423 24.36 2.527L24.081 2.29C24.165 2.148 24.269 2.041 24.393 1.969C24.519 1.895 24.663 1.858 24.825 1.858C24.963 1.858 25.083 1.885 25.185 1.939C25.289 1.993 25.369 2.068 25.425 2.164C25.481 2.26 25.509 2.372 25.509 2.5C25.509 2.586 25.498 2.664 25.476 2.734C25.456 2.804 25.421 2.874 25.371 2.944C25.323 3.012 25.256 3.089 25.17 3.175L24.591 3.766H24.078ZM24.078 4V3.766L24.426 3.646H25.554V4H24.078Z" fill="white" />
                                <defs>
                                    <clipPath id="clip0_3001_800">
                                        <rect width="17.3432" height="17.3432" fill="white" transform="translate(6.30664 8.30664)" />
                                    </clipPath>
                                </defs>
                            </svg>
                                
                                {cartCount > 0 && (
                                    <span className="absolute -top-2 -right-2 bg-red-600 text-white 
                                        text-[14px] font-semibold px-2 py-[2px] rounded-full">
                                        {cartCount}
                                    </span>
                                )}
                            </Link>
                        </div>
                    </div>
                </div>
            </div>


            {/* NAVBAR */}
            <div className='w-full bg-[#01C6B5] py-[25px]'>
                <div className='max-w-[1140px] px-3 mx-auto'>
                    <div className='flex items-center justify-between'>
                        <Link to={"/"} className='logo  font-normal text-[16px] leading-[100%] tracking-[0%] text-white'>
                            <img src="/assets/images/png/Logo_image.png" alt="logo" className='w-full' />
                        </Link>
                        <div className={`flex items-center menulist max-lg:justify-center gap-[36px] z-9  top-0 gap-6 max-sm:flex-col sm:flex-row transition-[right] duration-300  max-sm:h-full max-sm:w-full max-sm:bg-[#01C6B5] max-sm:fixed ${menuOpen === "show" ? 'right-0' : 'max-sm:-right-full'}`}>
                            {navlinks.map((item, i) => {
                                return <Link key={i} href="#" to={item=== "cart" ? "/cart" : "/"} className='font-normal text-[16px] leading-[100%] tracking-[0%] text-white capitalize relative inline-block group' >{item}
                                    <span
                                        className="absolute left-0 -bottom-1 w-0 h-0.5 bg-[#E6EDF0] transition-all duration-300 group-hover:w-full rounded"></span>
                                </Link>
                            })}
                        </div>
                        <button
                            onClick={() => setMenuOpen(menuOpen === "show" ? null : "show")}
                            className="flex flex-col justify-between h-5.5 w-7 bg-transparent border-0 ml-auto z-9 relative sm:hidden  cursor-pointer"
                        >
                            <span className={`block w-full h-0.75 bg-white rounded-sm transition-all duration-300 ease-in-out transform ${menuOpen === "show" ? "rotate-45 origin-left" : ""}`}></span>
                            <span className={`block w-full h-0.75 bg-white rounded-sm transition-all duration-300 ease-in-out ${menuOpen === "show" ? "opacity-0 -translate-x-10" : ""}`}></span>
                            <span className={`block w-full h-0.75 bg-white rounded-sm transition-all duration-300 ease-in-out transform ${menuOpen === "show" ? "-rotate-45 origin-left" : ""}`}></span>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    )
}

export default Navbar